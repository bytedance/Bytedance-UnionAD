<!DOCTYPE html>
<html>
<head>
<title>UnioniOSSDK_English.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family:  "Meiryo", "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

</head>
<body>
<h1 id="sdk-access-guideline-for-ios-devices%E2%80%94a-guideline-by-tiktok-audience-network">SDK Access Guideline for iOS Devices—A Guideline by TikTok Audience Network</h1>
<!-- TOC -->
<ul>
<li><a href="#sdk-access-guideline-for-ios-devicesa-guideline-by-tiktok-ad-network">SDK Access Guideline for iOS Devices—A Guideline by TikTok Audience Network</a>
<ul>
<li><a href="#1-sdk-access">1. SDK Access</a>
<ul>
<li><a href="#11-ios-sdk-framework">1.1 iOS SDK Framework</a>
<ul>
<li><a href="#111-apply-for-appid-and-slotid">1.1.1 Apply for AppID and SlotID</a></li>
<li><a href="#112-project-setting-import-framework">1.1.2 Project Setting Import Framework</a></li>
<li><a href="#method-one">Method One:</a></li>
<li><a href="#method-two">Method Two:</a></li>
</ul>
</li>
<li><a href="#12-xcode-compiler-option-settings">1.2 Xcode Compiler Option Settings</a>
<ul>
<li><a href="#121-add-permissions">1.2.1 Add Permissions</a></li>
<li><a href="#122-operating-environment-configuration">1.2.2 Operating Environment Configuration</a></li>
<li><a href="#123-add-dependency-libraries">1.2.3 Add Dependency Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#2-sdk-interface-and-ad-access">2. SDK Interface and Ad Access</a>
<ul>
<li><a href="#21-global-settings-buadsdkmanager">2.1 Global Settings (BUAdSDKManager)</a>
<ul>
<li><a href="#211-interface">2.1.1 Interface</a></li>
<li><a href="#212-use">2.1.2 Use</a></li>
</ul>
</li>
<li><a href="#22-rewarded-video-ad-burewardedvideoad">2.2 Rewarded Video Ad (BURewardedVideoAd)</a>
<ul>
<li><a href="#221-burewardedvideoad-interface">2.2.1 BURewardedVideoAd Interface</a></li>
<li><a href="#222-burewardedvideoad-callback">2.2.2 BURewardedVideoAd Callback</a></li>
<li><a href="#223-instance">2.2.3 Instance</a></li>
<li><a href="#224-burewardedvideomodel">2.2.4 BURewardedVideoModel</a></li>
<li><a href="#225-callback-from-server-to-server">2.2.5 Callback from Server to Server</a>
<ul>
<li><a href="#callback-mode">Callback Mode</a></li>
<li><a href="#signature-generation">Signature Generation</a></li>
<li><a href="#return">Return</a></li>
</ul>
</li>
<li><a href="#226-admob-aggregates-the-rewarded-video-ad-through-the-customevent-adapter">2.2.6 AdMob aggregates the rewarded video ad through the CustomEvent Adapter</a></li>
</ul>
</li>
<li><a href="#23-full-screen-video-ad-bufullscreenvideoad">2.3 Full-screen video ad (BUFullscreenVideoAd)</a>
<ul>
<li><a href="#231-bufullscreenvideoad-interface">2.3.1 BUFullscreenVideoAd Interface</a></li>
<li><a href="#232-bufullscreenvideoad-callback">2.3.2 BUFullscreenVideoAd Callback</a></li>
<li><a href="#233-instance">2.3.3 Instance</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#appendix">Appendix</a>
<ul>
<li><a href="#sdk-error-code">SDK Error Code</a></li>
<li><a href="#faq">FAQ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC -->
<h2 id="1-sdk-access">1. SDK Access</h2>
<h3 id="11-ios-sdk-framework">1.1 iOS SDK Framework</h3>
<h4 id="111-apply-for-appid-and-slotid">1.1.1 Apply for AppID and SlotID</h4>
<p>Please contact the TikTok Audience Network to apply for the AppID and SlotID.</p>
<h4 id="112-project-setting-import-framework">1.1.2 Project Setting Import Framework</h4>
<h4 id="method-one">Method One:</h4>
<p>Drag {BUAdSDK.framework, BUAdSDK.bundle} to project file after obtaining framework files.
Please select as below when dragging.</p>
<p><img src="images/bu_1.png" alt="image"></p>
<p>Please make sure Drag Copy Bundle Resource contains BUAdSDK.bundle, or icon picture may not load.</p>
<p><img src="images/bu_5.png" alt="image"></p>
<h4 id="method-two">Method Two:</h4>
<p>SDK version 2000 and after support pod access, simply configure pod environment, and add the following code to access the file in podfile.</p>
<pre class="hljs"><code><div>pod 'Bytedance-UnionAD', '~&gt; 2.0.0.0'
</div></code></pre>
<p>For more information about access through pod configuration, please refer to <a href="https://github.com/bytedance/Bytedance-UnionAD">Gitthub address</a>.</p>
<h3 id="12-xcode-compiler-option-settings">1.2 Xcode Compiler Option Settings</h3>
<h4 id="121-add-permissions">1.2.1 Add Permissions</h4>
<p><strong>Note the system library to be added.</strong></p>
<ul>
<li>To set project list file, click on the &quot;+&quot; sign to the right of information Property List to expand.</li>
</ul>
<p>To add App Transport Security Settings, click the arrow on the left to expand, and then click the plus sign on the right to Allow Arbitrary Loads option to be automatically added, the changed value is YES. SDK API fully supports HTTPS, but there are cases that advertisement creatives are non-HTTPS.</p>
<pre class="hljs"><code><div>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
&lt;true/&gt;
&lt;/dict&gt;
</div></code></pre>
<p>Detailed Steps:</p>
<p><img src="images/bu_2.png" alt="image"></p>
<ul>
<li>Other Linker Flags in Build Settings   Add parameter -ObjC, support -all_load SDK at the same time.</li>
</ul>
<p>Detailed Steps:</p>
<p><img src="images/bu_3.png" alt="image"></p>
<h4 id="122-operating-environment-configuration">1.2.2 Operating Environment Configuration</h4>
<ul>
<li>Support iOS 8.X and above</li>
<li>SDK compiler environment Xcode 10.0</li>
<li>Support architecture: i386, x86-64, armv7, armv7s, arm64</li>
</ul>
<h4 id="123-add-dependency-libraries">1.2.3 Add Dependency Libraries</h4>
<p>Project needs to find Link Binary With Libraries in TARGETS - &gt; Build Phases, click &quot;+&quot;, and then add the following dependent libraries in order.</p>
<ul>
<li>StoreKit.framework</li>
<li>MobileCoreServices.framework</li>
<li>WebKit.framework</li>
<li>MediaPlayer.framework</li>
<li>CoreMedia.framework</li>
<li>AVFoundation.framework</li>
<li>CoreTelephony.framework</li>
<li>SystemConfiguration.framework</li>
<li>AdSupport.framework</li>
<li>CoreMotion.framework</li>
<li>libresolv.9.tbd</li>
<li>libc++.tbd</li>
<li>libz.tbd
Detailed Steps:</li>
</ul>
<p><img src="images/bu_4.png" alt="image"></p>
<h2 id="2-sdk-interface-and-ad-access">2. SDK Interface and Ad Access</h2>
<h3 id="21-global-settings-buadsdkmanager">2.1 Global Settings (BUAdSDKManager)</h3>
<p>BUAdSDKManager is the inlet and interface of the entire SDK, you can set some SDK global information to obtain the set result by providing a class method.</p>
<h4 id="211-interface">2.1.1 Interface</h4>
<p>Currently, the interface provides the following class methods.</p>
<pre class="hljs"><code><div>/**
 Register the App key that’s already been applied before requesting an ad from TikTok Audience Network.
 @param appID : the unique identifier of the App
 */
+ (void)setAppID:(NSString *)appID;

/**
 Configure development mode.
 @param level : default BUAdSDKLogLevelNone
 */
+ (void)setLoglevel:(BUAdSDKLogLevel)level;

/// Set the gender of the user.
+ (void)setUserGender:(BUUserGender)userGender;

/// Set the age of the user.
+ (void)setUserAge:(NSUInteger)userAge;

/// Set the user's keywords, such as interests and hobbies, etc.
+ (void)setUserKeywords:(NSString *)keywords;

/// set additional user information.
+ (void)setUserExtData:(NSString *)data;

/// Set whether the app is a paid app, the default is a non-paid app
+ (void)setIsPaidApp:(BOOL)isPaidApp;

+ (NSString *)appID;
+ (BOOL)isPaidApp;
</div></code></pre>
<h4 id="212-use">2.1.2 Use</h4>
<p>SDK needs to be initialized in AppDelegate method</p>
<p><code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code></p>
<p>The following settings are mandatory settings for appID setup:</p>
<pre class="hljs"><code><div>[BUAdSDKManager setAppID:@&quot;xxxxxx&quot;];
</div></code></pre>
<p>See SDK Demo Project for more usage.</p>
<h3 id="22-rewarded-video-ad-burewardedvideoad">2.2 Rewarded Video Ad (BURewardedVideoAd)</h3>
<ul>
<li>**What is it:**A Rewarded video ad is a new ad format where users can choose to watch video ads in exchange for rewards such as virtual currency, in-app items and exclusive content, etc. The length of such ads is 15-30 seconds, it cannot be skipped, and an end page will be displayed at the end of the ad to guide the user for follow-up actions.</li>
</ul>
<h4 id="221-burewardedvideoad-interface">2.2.1 BURewardedVideoAd Interface</h4>
<p><strong>It is required to generate a new BURewardedVideoAd object each time calling the loadAdData method to request the latest rewarded video ad. Please do not reuse the local cache rewarded video ad.</strong></p>
<pre class="hljs"><code><div>@interface BURewardedVideoAd : NSObject
@property (nonatomic, strong) BURewardedVideoModel *rewardedVideoModel;
@property (nonatomic, weak, nullable) id&lt;BURewardedVideoAdDelegate&gt; delegate;

/**
Whether material is effective.
Setted to YES when data is not empty and has not been displayed.
Repeated display is not billed.
*/
@property (nonatomic, getter=isAdValid, readonly) BOOL adValid;

- (instancetype)initWithSlotID:(NSString *)slotID rewardedVideoModel:(BURewardedVideoModel *)model;
- (void)loadAdData;
- (BOOL)showAdFromRootViewController:(UIViewController *)rootViewController;

@end
</div></code></pre>
<h4 id="222-burewardedvideoad-callback">2.2.2 BURewardedVideoAd Callback</h4>
<pre class="hljs"><code><div>@protocol BURewardedVideoAdDelegate &lt;NSObject&gt;

@optional

/**
This method is called when video ad material loaded successfully.
*/
- (void)rewardedVideoAdDidLoad:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad materia failed to load.
@param error : the reason of error
*/
- (void)rewardedVideoAd:(BURewardedVideoAd *)rewardedVideoAd didFailWithError:(NSError *)error;

/**
This method is called when video cached successfully.
*/
- (void)rewardedVideoAdVideoDidLoad:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad slot will be showing.
*/
- (void)rewardedVideoAdWillVisible:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad slot has been shown.
*/
- (void)rewardedVideoAdDidVisible:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad is about to close.
*/
- (void)rewardedVideoAdWillClose:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad is closed.
*/
- (void)rewardedVideoAdDidClose:(BURewardedVideoAd *)rewardedVideoAd;

/**
This method is called when video ad is clicked.
*/
- (void)rewardedVideoAdDidClick:(BURewardedVideoAd *)rewardedVideoAd;


/**
This method is called when video ad play completed or an error occurred.
@param error : the reason of error
*/
- (void)rewardedVideoAdDidPlayFinish:(BURewardedVideoAd *)rewardedVideoAd didFailWithError:(NSError *)error;

/**
Server verification which is requested asynchronously is succeeded.
@param verify :return YES when return value is 2000.
*/
- (void)rewardedVideoAdServerRewardDidSucceed:(BURewardedVideoAd *)rewardedVideoAd verify:(BOOL)verify;

/**
Server verification which is requested asynchronously is failed.
Return value is not 2000.
*/
- (void)rewardedVideoAdServerRewardDidFail:(BURewardedVideoAd *)rewardedVideoAd;
/**
This method is called when the user clicked skip button.
*/
- (void)rewardedVideoAdDidClickSkip:(BURewardedVideoAd *)rewardedVideoAd;
@end

</div></code></pre>
<h4 id="223-instance">2.2.3 Instance</h4>
<pre class="hljs"><code><div>BURewardedVideoModel *model = [[BURewardedVideoModel alloc] init];
model.userId = @&quot;123&quot;;
model.isShowDownloadBar = YES;
self.rewardedVideoAd = [[BURewardedVideoAd alloc] initWithSlotID:self.viewModel.slotID rewardedVideoModel:model];
self.rewardedVideoAd.delegate = self;
[self.rewardedVideoAd loadAdData];
</div></code></pre>
<h4 id="224-burewardedvideomodel">2.2.4 BURewardedVideoModel</h4>
<pre class="hljs"><code><div>@interface BURewardedVideoModel : NSObject

/**
required.
Third-party game user_id identity.
Mainly used in the reward issuance, it is the callback pass-through parameter from server-to-server.
It is the unique identifier of each user.
In the non-server callback mode, it will also be pass-through when the video is finished playing.
Only the string can be passed in this case, not nil.
*/
@property (nonatomic, copy) NSString *userId;

//optional. reward name.
@property (nonatomic, copy) NSString *rewardName;

//optional. number of rewards.
@property (nonatomic, assign) NSInteger rewardAmount;

//optional. serialized string.
@property (nonatomic, copy) NSString *extra;

// Whether to display the download Bar, the default is YES.
@property (nonatomic, assign) BOOL isShowDownloadBar;

@end

</div></code></pre>
<h4 id="225-callback-from-server-to-server">2.2.5 Callback from Server to Server</h4>
<p>The server-to-server callback lets you decide whether to offer a reward to the user who views the ad. When the user successfully views the ad, you can configure a callback link from the TikTok server to your own server to inform the user that the action has been completed.</p>
<h5 id="callback-mode">Callback Mode</h5>
<p>The TikTok server will request the callback link of the third-party service in GET mode, and callback the following parameters:</p>
<p>user_id=%s&amp;trans_id=%s&amp;reward_name=%s&amp;reward_amount=%d&amp;extra=%s&amp;sign=%s</p>
<table>
<thead>
<tr>
<th>Field Definition</th>
<th>Field Name</th>
<th>Field Type</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>sign</td>
<td>Sign</td>
<td>string</td>
<td>Sign</td>
</tr>
<tr>
<td>user_id</td>
<td>User id</td>
<td>string</td>
<td>Call SDK pass-through，app's unique user identifier</td>
</tr>
<tr>
<td>trans_id</td>
<td>Transaction id</td>
<td>string</td>
<td>Unique transaction ID for completing viewing the ad</td>
</tr>
<tr>
<td>reward_amount</td>
<td>number of rewards</td>
<td>int</td>
<td>TikTok Audience Network configuration or call SDK input</td>
</tr>
<tr>
<td>reward_name</td>
<td>Name of rewards</td>
<td>string</td>
<td>TikTok Audience Network configuration or call SDK input</td>
</tr>
<tr>
<td>extra</td>
<td>Extra</td>
<td>string</td>
<td>Call SDKin put and pass-through，leave it empty if not needed</td>
</tr>
</tbody>
</table>
<h5 id="signature-generation">Signature Generation</h5>
<p>appSecurityKey: The key you get for adding rewarded video ad code bit on the TikTok Audience Network transId: transaction id sign = sha256(appSecurityKey:transId)
Python sample:</p>
<pre class="hljs"><code><div>import hashlib

if __name__ == &quot;__main__&quot;:
trans_id = &quot;6FEB23ACB0374985A2A52D282EDD5361u6643&quot;
app_security_key = &quot;7ca31ab0a59d69a42dd8abc7cf2d8fbd&quot;
check_sign_raw = &quot;%s:%s&quot; % (app_security_key, trans_id)
sign = hashlib.sha256(check_sign_raw).hexdigest()
</div></code></pre>
<h5 id="return">Return</h5>
<p>Returns json data with the following fields:</p>
<table>
<thead>
<tr>
<th>Field Definition</th>
<th>Field Name</th>
<th>Field Type</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td>isValid</td>
<td>Validation result</td>
<td>bool</td>
<td>determines the result, whether to award or not</td>
</tr>
</tbody>
</table>
<p>Instance:</p>
<pre class="hljs"><code><div>{
&quot;isValid&quot;: true
}
</div></code></pre>
<h4 id="226-admob-aggregates-the-rewarded-video-ad-through-the-customevent-adapter">2.2.6 AdMob aggregates the rewarded video ad through the CustomEvent Adapter</h4>
<p>There are two ways to aggregate rewarded video ads through AdMob. The first is through the AdMob ad alliance and the second is through the CustomEvent Adapter. Currently, Toutiao supports only the second method, you need to configure CustomEvent and implement CustomEvent Adapter. Please refer to <a href="https://developers.google.com/admob/ios/rewarded-video-adapters?hl=zh-CN">the Rewarded Video Adapters</a> official website for guidance.</p>
<p>Please refer to the official Guide on <a href="https://developers.google.com/admob/ios/rewarded-video?hl=zh-CN">Rewarded Video ads</a> for ways to access rewarded video ads.</p>
<p>Please refer to <a href="https://developers.google.com/admob/ios/test-ads?hl=zh-CN#enable_test_devices">Test Ads</a> for ad tests.</p>
<p>In order to avoid stepping on pit value, please note the following:</p>
<ul>
<li><strong>When configuring CustomEvent, the Class Name and the implemented Adapter class name must be the same. Otherwise, the adapter cannot be called.</strong></li>
<li><strong>The default setting for iOS simulator is Enable test device type, it can only get Google Test Ads, not Toutiao test ads, to test Toutiao ads, please use a real iOS device, and do not add it as an AdMob TestDevice</strong></li>
</ul>
<h3 id="23-full-screen-video-ad-bufullscreenvideoad">2.3 Full-screen video ad (BUFullscreenVideoAd)</h3>
<ul>
<li><strong>What is it:</strong> A Full-screen video ad is a full-screen video ad. Users can choose to insert the ad in different scenes; these ads are 15-30 seconds long, and can be skipped, and an end page will be displayed at the end of the ad to guide the user for follow-up actions.</li>
</ul>
<h4 id="231-bufullscreenvideoad-interface">2.3.1 BUFullscreenVideoAd Interface</h4>
<p><strong>It is required to generate a new BUFullscreenVideoAd object each time calling the loadAdData method to request the latest rewarded video ad. Please do not reuse the local cache rewarded video ad.</strong></p>
<pre class="hljs"><code><div>@interface BUFullscreenVideoAd : NSObject

@property (nonatomic, weak, nullable) id&lt;BUFullscreenVideoAdDelegate&gt; delegate;
@property (nonatomic, getter=isAdValid, readonly) BOOL adValid;

/**
Initializes video ad with slot id.
@param slotID : the unique identifier of video ad.
@return BUFullscreenVideoAd
*/
- (instancetype)initWithSlotID:(NSString *)slotID;

/**
Load video ad datas.
*/
- (void)loadAdData;

/**
Display video ad.
@param rootViewController : root view controller for displaying ad.
@return : whether it is successfully displayed.
*/
- (BOOL)showAdFromRootViewController:(UIViewController *)rootViewController;

@end
</div></code></pre>
<h4 id="232-bufullscreenvideoad-callback">2.3.2 BUFullscreenVideoAd Callback</h4>
<pre class="hljs"><code><div>@protocol BUFullscreenVideoAdDelegate &lt;NSObject&gt;

@optional

/**
This method is called when video ad material loaded successfully.
*/
- (void)fullscreenVideoMaterialMetaAdDidLoad:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad materia failed to load.
@param error : the reason of error
*/
- (void)fullscreenVideoAd:(BUFullscreenVideoAd *)fullscreenVideoAd didFailWithError:(NSError *)error;

/**
This method is called when video cached successfully.
*/
- (void)fullscreenVideoAdVideoDataDidLoad:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad slot will be showing.
*/
- (void)fullscreenVideoAdWillVisible:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad slot has been shown.
*/
- (void)fullscreenVideoAdDidVisible:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad is clicked.
*/
- (void)fullscreenVideoAdDidClick:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad is about to close.
*/
- (void)fullscreenVideoAdWillClose:(BUFullscreenVideoAd *)fullscreenVideoAd;

/**
This method is called when video ad is closed.
*/
- (void)fullscreenVideoAdDidClose:(BUFullscreenVideoAd *)fullscreenVideoAd;


/**
This method is called when video ad play completed or an error occurred.
@param error : the reason of error
*/
- (void)fullscreenVideoAdDidPlayFinish:(BUFullscreenVideoAd *)fullscreenVideoAd didFailWithError:(NSError *)error;

/**
This method is called when the user clicked skip button.
*/
- (void)fullscreenVideoAdDidClickSkip:(BUFullscreenVideoAd *)fullscreenVideoAd;

@end
</div></code></pre>
<h4 id="233-instance">2.3.3 Instance</h4>
<pre class="hljs"><code><div>- (void)viewDidLoad {
	[super viewDidLoad];
	// Do any additional setup after loading the view.
	#warning----- Every time the data is requested, a new one BUFullscreenVideoAd needs to be initialized. Duplicate request data by the same full screen video ad is not allowed.
	self.fullscreenVideoAd = [[BUFullscreenVideoAd alloc] initWithSlotID:self.viewModel.slotID];
	self.fullscreenVideoAd.delegate = self;
	[self.fullscreenVideoAd loadAdData];
	[self.view addSubview:self.button];
}

- (UIButton *)button {
	if (!_button) {
		CGSize size = [UIScreen mainScreen].bounds.size;
		_button = [[BUDNormalButton alloc] initWithFrame:CGRectMake(0, size.height*0.75, 0, 0)];
		[_button setTitle:[NSString localizedStringForKey:ShowFullScreenVideo] forState:UIControlStateNormal];
		[_button addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside];
	}
	return _button;
}

- (void)buttonTapped:(id)sender {
	/**Return YES when material is effective,data is not empty and has not been displayed.
	Repeated display is not charged.
	*/
	[self.fullscreenVideoAd showAdFromRootViewController:self.navigationController];
}

</div></code></pre>
<h2 id="appendix">Appendix</h2>
<h3 id="sdk-error-code">SDK Error Code</h3>
<p>Mainly handling data acquisition exception in the callback method.</p>
<pre class="hljs"><code><div>- (void)rewardedVideoAd:(BURewardedVideoAd *)rewardedVideoAd didFailWithError:(NSError *)error;
- (void)fullscreenVideoAd:(BUFullscreenVideoAd *)fullscreenVideoAd didFailWithError:(NSError *)error;
</div></code></pre>
<p>Below are the values of various error codes.</p>
<pre class="hljs"><code><div>
BUErrorCodeTempError        = -6, // native template is invalid
BUErrorCodeTempAddationError= -5, // native template addation is invalid
BUErrorCodeOpenAPPStoreFail = -4, // failed to open appstore
BUErrorCodeNOAdError        = -3, // parsed data has no ads
BUErrorCodeNetError         = -2, // network request failed
BUErrorCodeParseError       = -1, // parsing failed

BUErrorCodeParamError       = 10001,  // parameter error
BUErrorCodeTimeout          = 10002,

BUErrorCodeSuccess          = 20000,
BUErrorCodeNOAD             = 20001,  // no ads

BUErrorCodeContentType      = 40000,  // http conent_type error
BUErrorCodeRequestPBError   = 40001,  // http request pb error
BUErrorCodeAppEmpty         = 40002,  // request app can't be empty
BUErrorCodeWapEMpty         = 40003,  // request wap can't be empty
BUErrorCodeAdSlotEmpty      = 40004,  // missing ad slot description
BUErrorCodeAdSlotSizeEmpty  = 40005,  // the ad slot size is invalid
BUErrorCodeAdSlotIDError    = 40006,  // the ad slot ID is invalid
BUErrorCodeAdCountError     = 40007,  // request the wrong number of ads
BUErrorCodeAdPackageIncomplete = 40025, // the SDK package is incomplete. It is recommended to verify the integrity of SDK package or contact technical support.

BUErrorCodeSysError         = 50001   // ad server error
</div></code></pre>
<h3 id="faq">FAQ</h3>
<ol>
<li>
<p>The iOS ad page opens in our app and there is no way to close or go back to the previous page.
A: It can't go back because your home page ViewController has hidden the NavigationBar.</p>
</li>
<li>
<p>Found a leak in TTRUIWebView class of the BUWebViewController class in the TikTok SDK.
A: It is a system problem. UIWebView has a consistent leak. We will consider replacing it with WKWebView.</p>
</li>
<li>
<p>Can I set the orientation for rewarded video ads?
A: The orientation is arranged by the sdk according to the current screen state. No developer settings are required. The backend will return the corresponding creative (horizontal material, vertical material).</p>
</li>
<li>
<p>What is a userId?
A: Third-party game user_id identifier, a must pass parameter (mainly used in reward issuance, it is the callback pass-through parameter from server-to-server and it is the unique identifier of each user; in the non-server callback mode, there's also pass-through back to the app when the video is finished playing.) only the string can be passed in this case, not nil;</p>
</li>
<li>
<p>What is the package size for iOS integration?
A: Our demo package is about 580kb. However, the specific size will be different according to the imported function. The actual size is based on the integrated package size.</p>
</li>
<li>
<p>What is the difference between callback of the successful loading of rewarded video ad material and callback of the successful cashing of  video material ?
A: The successful loading of rewarded video ad material means that the creatives of the ad material is loaded, then the ad can be displayed, but since the video is loaded by a separate thread, the video data is not cached, and the video may be delayed if the network is not good since videos are playing real-time. For a better watching experience, it is recommended to display ads when the ad video material cache is successful.</p>
</li>
</ol>

</body>
</html>
